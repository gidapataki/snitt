<!DOCTYPE html>
<html lang="hu">
<head>
<meta charset="UTF-8" />
<title>resizing test</title>
<style type="text/css"> 

html, body { background-color: #333; color: #eee; margin: 0; padding: 0; height: 100%; }
#main { min-height: 100%; position: relative; }

#h1 { background-color: #444; height: 70px; overflow: auto; }
#h2 { background-color: #000; height: 20px }
#b1 { float: left; background-color: #323; width: 400px; height: 400px; }
#b2 { float: left; background-color: #423; width: 500px; height: 400px; }
#b21 { background-color: #223; width: 500px; height: 300px; }
#b22 { background-color: #233; width: 500px; height: 100px; overflow: auto; }
svg { display: block; }
img { background: #212; }

</style>
</head>
<body>

<div id="main">
    <div id="h1"><pre id="p"></pre></div>
    <div id="h2"></div>
    <div id="b1">
    
<!--    
<svg id="s" xmlns="http://www.w3.org/2000/svg" version="1.1" viewbox="50 0 120 120" width="200" height="100">
  <circle cx="120" cy="70" r="40" stroke="black" stroke-width="2" fill="red"/>
  <circle cx="100" cy="50" r="40" stroke="black" stroke-width="2" fill="red"/>
</svg>
-->

    </div>
    <div id="b2">
        <div id="b21"></div>
        <div id="b22">
<pre>so much shit

</pre>
          
        
        </div>
    </div>
</div>


<script language="javascript">


var info=document.getElementById("p");
var lines=0;

function msg(s) {
    if (lines>0) { info.innerHTML+="\n"; }
    ++lines;
    info.innerHTML+=lines.toString() + " " + s;
}

    
function getOffset(el) {
    var _x=0;
    var _y=0;
    while( el && !isNaN( el.offsetLeft ) && !isNaN( el.offsetTop ) ) {
        _x += el.offsetLeft - el.scrollLeft;
        _y += el.offsetTop - el.scrollTop;
        el = el.offsetParent;
    }
    return [_x, _y];
}


function idOffset(id) {
    return getOffset(document.getElementById(id));
} 


function msgOffset(id) {
    var off=idOffset(id);
    msg(id+" "+off);
}


msgOffset("h1");
msgOffset("h2");
msgOffset("b1");
msgOffset("b2");
msgOffset("b21");
msgOffset("b22");

function element(id) {
    return document.getElementById(id);
}



function relayout() {
    var W=window.innerWidth;
    var H=window.innerHeight;

    var b1=element("b1");
    var b21=element("b21");
    var b22=element("b22");
    var top=getOffset(b1)[1];
    var bh=(H-top)+"px";
    var b2h=(H-top-b22.clientHeight)+"px";
    
    b1.style.height=bh;
    b2.style.height=bh;
    b21.style.height=b2h;
    
    
}

relayout();

window.onresize=relayout;


var xmlns="http://www.w3.org/2000/svg";
var svg=document.createElementNS(xmlns, "svg");
b1.appendChild(svg);

svg.setAttribute("id", "s2");
//svg.setAttribute("xmlns", "http://www.w3.org/2000/svg");
svg.setAttribute("version", "1.1");
svg.setAttribute("viewbox", "50 0 120 120");
svg.setAttribute("width", "200");
svg.setAttribute("height", "100");


//svg.style.width="200px";
//svg.style.height="100px";
svg.style.backgroundColor="#212";

var g=document.createElementNS(xmlns, "g");
svg.appendChild(g);

var cc=document.createElementNS(xmlns, "circle");
cc.setAttribute("r","40");
cc.setAttribute("cx","40");
cc.setAttribute("cy","40");
cc.setAttribute("fill","red");
g.appendChild(cc);

cc=document.createElementNS(xmlns, "circle");
cc.setAttribute("r","40");
cc.setAttribute("cx","60");
cc.setAttribute("cy","60");
cc.setAttribute("fill","red");

g.appendChild(cc);
var i=0;

//while(svg.lastChild) { svg.removeChild(svg.lastChild); ++i; }

console.debug(i);

//svg.appendChild(document.createElementNS(xmlns, "g"));

// svg save

function svgdata(id) {
    var svg=element(id);
    var svg_xml=(new XMLSerializer()).serializeToString(svg)
    var svg_dataurl="data:image/svg+xml;base64," + window.btoa(svg_xml);
    return svg_dataurl;
}

//var ax=document.createElement("img");
//element("b1").appendChild(ax);
//ax.src=svgdata("s");


</script>
</body>
</html>

